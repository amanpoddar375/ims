{"ast":null,"code":"import { HttpClient } from '@angular/common/http';\nimport { BehaviorSubject, tap } from 'rxjs';\nimport { environment } from '../../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport let AuthService = /*#__PURE__*/(() => {\n  class AuthService {\n    constructor(http) {\n      this.http = http;\n      this.currentUser$ = new BehaviorSubject(null);\n      this.authHeader = null;\n      const cachedUser = localStorage.getItem('auth:user');\n      const cachedHeader = localStorage.getItem('auth:header');\n      if (cachedUser) {\n        this.currentUser$.next(JSON.parse(cachedUser));\n      }\n      if (cachedHeader) {\n        this.authHeader = cachedHeader;\n      }\n    }\n    me() {\n      return this.http.get(`${environment.api}/auth/me`).pipe(tap(res => this.saveAuth(res.data, this.authHeader)));\n    }\n    login(username, password) {\n      const header = btoa(`${username}:${password}`);\n      return this.http.post(`${environment.api}/auth/login`, {\n        username,\n        password\n      }).pipe(tap(res => this.saveAuth(res.data, header)));\n    }\n    register(username, password, email) {\n      const header = btoa(`${username}:${password}`);\n      return this.http.post(`${environment.api}/auth/register`, {\n        username,\n        password,\n        email\n      }).pipe(tap(res => this.saveAuth(res.data, header)));\n    }\n    logout() {\n      this.currentUser$.next(null);\n      this.authHeader = null;\n      localStorage.removeItem('auth:user');\n      localStorage.removeItem('auth:header');\n    }\n    get user() {\n      return this.currentUser$.asObservable();\n    }\n    get snapshot() {\n      return this.currentUser$.value;\n    }\n    get authorizationHeader() {\n      return this.authHeader;\n    }\n    saveAuth(user, header) {\n      this.currentUser$.next(user);\n      this.authHeader = header;\n      localStorage.setItem('auth:user', JSON.stringify(user));\n      if (header) {\n        localStorage.setItem('auth:header', header);\n      }\n    }\n    static {\n      this.ɵfac = function AuthService_Factory(t) {\n        return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: AuthService,\n        factory: AuthService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return AuthService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}